cmake_minimum_required(VERSION 3.19)
cmake_policy(SET CMP0074 NEW)

project(OCRA LANGUAGES CXX)

#[[Rendering API]]
set(OCRA_API_IMPL "OpenGL" CACHE STRING
  "API Impl used at compile-time")
set(OCRA_API_IMPL_VALUES
  "OpenGL;Vulkan;DirectX")
set_property(CACHE OCRA_API_IMPL PROPERTY STRINGS ${OCRA_API_IMPL_VALUES})
add_compile_definitions(OCRA_API_IMPL=${OCRA_API_IMPL})

set(OCRA_API_HEADER_FILES
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Allocator.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Buffer.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Device.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/FrameBuffer.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Handle.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Instance.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Memory.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/PhysicalDevice.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/QueryPool.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/RenderPass.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Queue/Queue.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Queue/Fence.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Queue/Semaphore.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/Blend.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/Compare.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/Extent.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/Extent2D.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/Extent3D.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/IndexType.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/Logic.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/Offset3D.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/Rect2D.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/Rect3D.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/ScissorTest.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/SharingMode.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/Stencil.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/Timer.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/Vec.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/Vec2.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/Vec3.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/Vec4.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/Vec_Boolean.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/Vec_Functor.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/Vec_Interpolation.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/Vec_Math.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Common/VertexType.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Command/Buffer.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Command/Draw.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Command/MemoryBarrier.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Command/Pool.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Command/Query.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Command/Scissor.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Command/ViewPort.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Descriptor/Set.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Descriptor/SetLayout.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Descriptor/Pool.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Descriptor/Type.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Image/Descriptor.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Image/Filter.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Image/Format.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Image/Image.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Image/Sampler.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Image/Usage.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Image/View.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Pipeline/ColorBlendState.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Pipeline/DepthStencilState.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Pipeline/Graphics.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Pipeline/InputAssemblyState.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Pipeline/MultisampleState.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Pipeline/Pipeline.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Pipeline/RasterizationState.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Pipeline/ShaderPipelineState.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Pipeline/TessellationState.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Pipeline/VertexInputState.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Pipeline/ViewPortState.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Primitive/Topology.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Shader/Module.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/Shader/Stage.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/State/Clear.hpp
  ${CMAKE_CURRENT_SOURCE_DIR}/include/OCRA/State/Draw.hpp
)

add_library(OCRA-API-Interface INTERFACE ${OCRA_API_HEADER_FILES})
add_library(OCRA::API::Interface ALIAS OCRA-API-Interface)
set_target_properties(OCRA-API-Interface PROPERTIES LINKER_LANGUAGE CXX)
target_include_directories(OCRA-API-Interface INTERFACE
  "${CMAKE_CURRENT_SOURCE_DIR}/include")
set_target_properties(
  OCRA-API-Interface
  PROPERTIES FOLDER "API"
)

if (OCRA_API_IMPL STREQUAL "OpenGL")
add_subdirectory(Driver/OpenGL)
endif (OCRA_API_IMPL STREQUAL "OpenGL")

if(MSVC_IDE)
  set(CMAKE_DEBUG_POSTFIX "d")
  # Run macro
  GroupSources(src)
  GroupSources(include)
endif()
